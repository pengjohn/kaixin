/*!
*@FileName: KaiXinApp_CommentDetail.h
*@Author: GoZone
*@Date:
*@Log: 	Author 			Date 		Description
*
*@section Copyright
* =======================================================================<br>
*          Copyright ? 2010-2012 GOZONE <br>
*                All Rights Reserved.<br>
* The file is generated by Kaixin_Component Wizard for Tranzda Mobile Platform <br>
* =======================================================================<br>
*/

#ifndef  __KAIXINAPI_COMMENTDETAIL_H__
#define  __KAIXINAPI_COMMENTDETAIL_H__

#include "KaiXinAPI.h"

#define COMMENTDETAIL_MAXITEM 100 //Set the Max detail items can be showed in phone is 100

typedef struct
{
	char flogo[128];
	int cid;
	int fuid;
	char fname[32];
	char abscont[60*2];
	int ctime;
	char strctime[32];
}CommentDetail_comments;

typedef struct
{
	int ret;
	char uid[32];
	int n;
	char thread_cid[32];//int thread_cid;
	char mtype[32];
	char flogo[128];
	int cnum;
	int more;

	//new added
	char title[128];
	char thumbnail[256];
	char appid[32];


	int  nSize;  //Save the array size by code_gen tools. 
	CommentDetail_comments*  comments;
}tResponseCommentDetail;

typedef enum
{
	ReceivedUserCommentDetail=0,
	SentUserCommentDetail,

	ReceivedCommentDetail,
	SentCommentDetail,

	FriendCommentDetail,
	ReceivedAnObjectCommentDetail,
	AppCommeetailTypeEnd
}AppCommentDetailType;

extern void* KaiXinAPI_CommentDetail_JsonParse(char *text);

class TCommentDetailForm : public TWindow
{
public:
	TCommentDetailForm(TApplication* pApp);
	TCommentDetailForm(TApplication* pApp, AppCommentDetailType appCommentDetailType);	
	virtual ~TCommentDetailForm(void);
	virtual Boolean EventHandler(TApplication * appP, EventType * eventP);

private:
	Boolean _OnWinInitEvent(TApplication * pApp, EventType * pEvent);
	Boolean _OnWinClose(TApplication * pApp, EventType * pEvent);
	Boolean _OnCtrlSelectEvent(TApplication * pApp, EventType * pEvent);
	Int32 _OnCommentDetailControl(TApplication * pApp);
	Int32 SetTilteButton(TApplication * pApp);	
	Int32 SetFormTilte(TApplication * pApp);	
	void SetTitleString(AppCommentDetailType appCommentDetailType);
	void SetDetailData(AppCommentDetailType appCommentDetailType);
	Int32 CreateDetailItemControl(Int32 itemIndex,Int32 itemHeight, TPanel *pTPanel, int ctrlGroupIndex);
	void GoToReplyInterface(TApplication * pApp, AppCommentDetailType appCommentDetailType);
	Int32 GoToDeleteComment(TApplication * pApp, AppCommentDetailType appCommentDetailType);

private:	
	int m_nCommentDetailItemNum;
	tResponseCommentDetail* m_pResponse;	
	AppCommentDetailType m_appCommentDetailType;	

	//control 
	Int32 m_iaCreateCtlID[(COMMENTDETAIL_MAXITEM+2)*5];
	TCtrl *m_obContrl[(COMMENTDETAIL_MAXITEM+2)*5];
	Int32 m_nCtlIDCount;

	Int32 m_nReplyBtnID; //记录回复按钮ID	
	Int32 m_nDeleteBtnID; //记录删除按钮ID		
	Int32 m_nTitleReplyBtnID; //记录标题栏回复按钮ID	
	Int32 m_nTitleLblID; //记录标题标签iD		

	//TPanel ID
	Int32 m_iaTPanelID[2];
	Int32 m_iaTImageID[COMMENTDETAIL_MAXITEM];


	TBitmap* pBmp[COMMENTDETAIL_MAXITEM];//For user photo	
	Int32	m_BackBtn;
};

#endif
